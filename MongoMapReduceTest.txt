100161217377	3/1/2015	A
100161217377	6/1/2015	A
100161217377	9/1/2015	A
100161217377	12/1/2015	A
100161217377	3/1/2016	A
100161217377	6/1/2016	A
100161217377	9/1/2016	A
100161217377	12/1/2016	A
100161217377	3/1/2017	B
100161217377	6/1/2017	A
100161217377	9/1/2017	A
100161217377	12/1/2017	A
100184875206	3/1/2015	A
100184875206	6/1/2015	A
100184875206	9/1/2015	A
100184875206	12/1/2015	A
100184875206	3/1/2016	B
100184875206	6/1/2016	C
100254873222	3/1/2015	A
100254873222	6/1/2015	A
100254873222	9/1/2015	A
100254873222	12/1/2015	A
100254873222	3/1/2016	A
100254873222	6/1/2016	A
100254873222	9/1/2016	A
100254873222	12/1/2016	A
100254873222	3/1/2017	A
100254873222	6/1/2017	B
100254873222	9/1/2017	B
100254873222	12/1/2017	B
100254873222	3/1/2018	A
100254873222	6/1/2018	A
100254873222	9/1/2018	A
100254873222	12/1/2018	A
100404088327	3/1/2015	A
100404088327	6/1/2015	A
100404088327	9/1/2015	A
100404088327	12/1/2015	A
100404088327	3/1/2016	A
100404088327	6/1/2016	A
100404088327	9/1/2016	C
100404088327	12/1/2016	B
100404088327	3/1/2017	A
100404088327	6/1/2017	A
100404088327	9/1/2017	C
100404088327	12/1/2017	A
100404088327	3/1/2018	A
100404088327	6/1/2018	A
100404088327	9/1/2018	A
100404088327	12/1/2018	A


db.performance.insert("LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(3, 1, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A")
		
		3/1/2015	A
		
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"B"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100161217377, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100184875206, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100184875206, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100184875206, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100184875206, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100184875206, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"B"})
db.performance.insert({"LOAN_IDENTIFIER":100184875206, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"C"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"B"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"B"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"B"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100254873222, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2015), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"C"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2016), "CURRENT_LOAN_DELINQUENCY_STATUS":"B"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"C"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2017), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 3, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 6, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 9, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})
db.performance.insert({"LOAN_IDENTIFIER":100404088327, "MONTHLY_REPORTING_PERIOD": new Date(1, 12, 2018), "CURRENT_LOAN_DELINQUENCY_STATUS":"A"})



var mapFunction1 = function() {
	emit(this.LOAN_IDENTIFIER, {MONTHLY_REPORTING_PERIOD: this.MONTHLY_REPORTING_PERIOD, CURRENT_LOAN_DELINQUENCY_STATUS: this.CURRENT_LOAN_DELINQUENCY_STATUS});
	
};

var reduceFunction1 = function(loan, loanDtl) {
	var count = 0;
	for (var idx = 0; idx < loanDtl.length; idx++) {
		count ++;
	}
	
	return ({LOAN_IDENTIFIER: loan, count: count});
};

db.performance.mapReduce(
	mapFunction1,
	reduceFunction1,
	{ out: "performance_out" }
)

db.performance_out.find()